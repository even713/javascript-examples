<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>d3 study</title>
	<style>
	.node{
		fill: #ccc;
		stroke: #fff;
		stroke-width: 2px;
	}

	.link{
		stroke: #777;
		stroke-width: 2px;
	}
	</style>
</head>
<body>
	<!-- <svg width="800" height="600">
		<g class="group" transform = "translate(50, 50)">
			<rect x="0" y ="0" width="100", height="100"/>
			<g class="node" transform="translate(50, 50)">
				<circle cx="50" cy="50" r="50"></circle>
			</g>
		</g>
	</svg> -->
</body>
<script src="../../vendor/d3/d3.v3.js"></script>
<script>
// study: draw svg shape
	// var p = d3.select("body")
	// 		.append("p")
	// 		.style("color", "red")
	// 		.text("Let's study d3!");

	// var canvas = d3.select("body")
	// 	.append("svg")
	// 	.attr("width", "500")
	// 	.attr("height", "500");

	// var circle = canvas.append("circle")
	// 				.attr("cx", 200)
	// 				.attr("cy", 200)
	// 				.attr("r", 50)
	// 				.attr("fill", "red");

	// var rect = canvas.append("rect")
	// 			.attr("x", 100)
	// 			.attr("y", 50)
	// 			.attr("width", 100)
	// 			.attr("height", 50);

	// var line = canvas.append("line")
	// 			.attr("x1", "10")
	// 			.attr("y1", "10")
	// 			.attr("x2", "400")
	// 			.attr("y2", "300")
	// 			.attr("stroke", "green")
	// 			.attr("stroke-width", "10");	

// study: visualizing data/ group and axis
	// var width = 500,
	// 	height = 600;

	// var widthScale = d3.scale.linear()
	// 					.domain([0, 60])
	// 					.range([0, width]);

	// var colorScale = d3.scale.linear()
	// 					.domain([0, 60])
	// 					.range(["red", "blue"]);

	// var axis = d3.svg.axis()
	// 				.ticks(4)
	// 				.scale(widthScale)
	// 				;					

	// var canvas = d3.select("body")
	// 				.append("svg")
	// 				.attr("width", width)
	// 				.attr("height", height)
	// 				.append("g")
	// 				.attr("transform", "translate(0, 20)");

	// var data = [60, 3, 30, 40];				
	// var bars = canvas.selectAll("rect")
	// 		.data(data)
	// 		.enter()
	// 		.append("rect")
	// 		.attr("x", 30)
	// 		.attr("y", function(d, i){return i * 100;})
	// 		.attr("width", function(d){
	// 			return widthScale(d);
	// 			//return d*10;
	// 		})
	// 		.attr("fill", function(d){
	// 			return colorScale(d);
	// 		})
	// 		.attr("height", 50);

	// var xAxis = canvas.append("g")
	// 				.attr("transform", "translate(0, 380)")
	// 				.call(axis);	

// study: Enter, update, exit
// var canvas = d3.select("body")
// 				.append("svg")
// 				.attr("width", 1000)
// 				.attr("height", 500);


// var data = [20];
// var circle1 = canvas.append("circle")
// 				.attr("cx", "500")
// 				.attr("cy", "100")
// 				.attr("r", "100");

// var circle2 = canvas.append("circle")
// 				.attr("cx", "200")
// 				.attr("cy", "100")
// 				.attr("r", "100");			

// var circle = canvas.selectAll("circle")
// 				.data(data) // the data selection
// 				.attr("fill", "red")
// 				.exit() // the removed selection
// 				.attr("fill", "green");

// // var circle = canvas.selectAll("circle")
// // 				.attr("fill", "red")
// // 				.data(data)
// // 				.enter()
// // 				.append("circle")
// // 				.attr("cx", "200")
// // 				.attr("cy", "100")
// // 				.attr("r", "100")
// // 				.attr("fill", "green");

// study: transaction
// var canvas = d3.select("body")
// 				.append("svg")
// 				.attr("width", "1000")
// 				.attr("height", "500")

// var circle = canvas.append("circle")
// 					.attr("cx", "80")
// 					.attr("cy", "50")
// 					.attr("r", 30);

// 	circle.transition()
// 			.duration("1000")
// 			//.delay("1000")
// 			.attr("cx", "200")
// 			.transition()
// 			.delay("2000")
// 			.attr("cy", "200")
// 			.each("start", function(d){
// 				d3.select(this).attr("fill", "red");
// 			});		

// study: array
// var data = [10, 20, 30, 40, 50];

// data.sort(d3.ascending);
// d3.extent(data); // [10, 50]
// d3.shuffle(data); //			

// study: load external data
// d3.csv("data1.csv", function(data){
// 	var canvas = d3.select("body").append("svg")
// 				.attr("width", 800)
// 				.attr("height", 500);

// 		canvas.selectAll("rect")
// 				.data(data)
// 				.enter()
// 				.append("rect")
// 				.attr("x", 10)
// 				.attr("y", function(d, i){
// 					return i * 50;
// 				})
// 				.attr("width", function(d){
// 					return d.age * 10;
// 				})
// 				.attr("height", 45)
// 				.attr("fill", "blue");

// });		

// study: path
// var canvas = d3.select("body").append("svg")
// 			.attr("width", 800)
// 			.attr("height", 500);

// var data = [
// 	{x: 10, y: 20},
// 	{x: 40, y: 60},
// 	{x: 40, y: 70}
// ];

// var line = d3.svg.line()
// 			.x(function(d){
// 				return d.x;
// 			})
// 			.y(function(d){
// 				return d.y;
// 			});

// 	canvas.selectAll("path")
// 			.data([data])
// 			.enter()
// 			.append("path")
// 			.attr("d", line)
// 			.attr("fill", "none")
// 			.attr("stroke", "#000")
// 			.attr("stroke-width", "10");

// study: arcs
// var canvas = d3.select("body").append("svg")
// 			.attr("width", 800)
// 			.attr("height", 500)
// 			.append("g")
// 			.attr("transform", "translate(100, 100)");

// var r = 100,
// 	p = Math.PI * 2; // whole round

// var arc = d3.svg.arc()
// 			.innerRadius(r-20)
// 			.outerRadius(r)
// 			.startAngle(0)
// 			.endAngle(p);

// 	canvas.append("path")
// 			.attr("d", arc);

// study: pie layout
 //var data = [10, 30, 80],
 var data = [{name: "one", value: 10}, {name: "two", value: 30}, {name: "three", value: 80}],
 	r = 300;

 var canvas = d3.select("body").append("svg")
 			.attr("width", 800)
 			.attr("height", 800);

 var color = d3.scale.ordinal()
 			.range(["red", "blue", "orange"]);

 var group = canvas.append("g")
 			.attr("transform", "translate(300, 300)")
//
// var circle = group.append("circle")
//		 .attr("r", r)
		// .attr("fill", "rgb(219, 27, 27)");

 // https://github.com/d3/d3-3.x-api-reference/blob/master/API-Reference.md
 var arc = d3.svg.arc()
 			.innerRadius(0)
 			.outerRadius(r);

 var pie	= d3.layout.pie()
 			.value(function(d){return d.value});
var pieData = pie(data);

 var arcs = group.selectAll(".arcs")
 			.data(pieData)
 			.enter()
 			.append("g")
 			.attr("class", "arcs");

 arcs.append("path")
 	// .attr("d", arc)
 	.attr("d", function(...args){
 		console.log(args);
 		return arc.apply(this, args)
 	})
 	.attr("fill", function(d, i){
 		return color(d.data.value);
 	})
		 .style("fill-opacity", "0.5")
 	;

 arcs.append("text")
 	.attr("transform", function(d){
			 console.log(d);
 		return "translate("+ arc.centroid(d) +")";
 	})
 	.attr("text-anchor", "middle")
 	.attr("font-size", "1.5em")
 	.text(function(d){return d.data.name})

// Study: tree layout/ diagonal
// var canvas = d3.select("body").append("svg")
// 				.attr("width", 500)
// 				.attr("height", 500);

// var diagonal = d3.svg.diagonal()
// 		.source({x: 10, y: 10})
// 		.target({x: 300, y: 300});

// canvas.append("path")
// 		.attr("d", diagonal)
// 		.attr("fill", "none")
// 		.attr("stroke", "black")	

// Study: tree layout/ cluster layout
// var canvas = d3.select("body").append("svg")
// 				.attr("width", 500)
// 				.attr("height", 500)
// 				.append("g")
// 				.attr("transform", "translate(50, 50)");

// // https://github.com/d3/d3-3.x-api-reference/blob/master/Tree-Layout.md
// // var tree = d3.layout.tree()
// // 			.size([400, 400]);

// var tree = d3.layout.cluster() // move the last level to the leaf
// 			.size([400, 400]);

// d3.json("treelayout1.json", function(data){
// 	var nodes = tree.nodes(data);
// 	var links = tree.links(nodes);
// 	console.table(nodes);
// 	console.table(links);

// 	// start to draw nodes
// 	var node = canvas.selectAll(".node")
// 				.data(nodes)
// 				.enter()
// 				.append("g")
// 				.attr("class", "node")
// 				// .attr("transform", function(d){
// 				// 	return "translate("+ d.x + "," + d.y +")";
// 				// });
// 				// if horizontal
// 				.attr("transform", function(d){
// 					return "translate("+ d.y + "," + d.x +")";
// 				});

// 	node.append("circle")
// 		.attr("r", 5)
// 		.attr("fill", "steelblue");

// 	node.append("text")
// 		.text(function(d){
// 			return d.name;
// 		});
// 	// end draw nodes	

// 	// start to draw lines
// 	//var diagonal = d3.svg.diagonal();
// 	// if horizontal
// 	var diagonal = d3.svg.diagonal()
// 				.projection(function(d){
// 					return [d.y, d.x];
// 				});

// 	canvas.selectAll(".link")
// 			.data(links)
// 			.enter()
// 			.append("path")
// 			.attr("class", "link")
// 			.attr("d", diagonal)
// 			.attr("fill",  "none")
// 			.attr("stroke", "steelblue");

// study: pack/bubble layout
// var width = 800,
// 	height = 600;

// var canvas = d3.select("body").append("svg")
// 			.attr("width", width)
// 			.attr("height", height)
// 			.append("g")
// 			.attr("transform", "translate(50, 50)");

// var pack = d3.layout.pack()
// 			.size([width, height - 50])
// 			.padding(10);

// d3.json("packlayout1.json", function(data){
// 	var nodes = pack.nodes(data);
// 	console.log(nodes);

// 	var node = canvas.selectAll(".node")
// 				.data(nodes)
// 				.enter()
// 				.append("g")
// 				.attr("class", "node")
// 				.attr("transform", function(d){
// 					return "translate("+ d.x +", "+d.y+")"
// 				});

// 	node.append("circle")
// 		.attr("r", function(d){
// 			return d.r;
// 		})
// 		//.attr("fill", "steelblue")
// 		.attr("fill", function(d){return d.children ? "#fff": "steelblue";})
// 		.attr("opacity", 0.25)
// 		//.attr("stroke", "#ccc")
// 		.attr("stroke", function(d){return d.children ? "#fff": "#ccc";})
// 		.attr("stroke-width", 2);

// 	node.append("text")
// 		.text(function(d){return d.children ? "" : d.name;})	

// });

//});					

// study: force layout
//var width = 800, height = 600;
//var circleR = width * 0.03;
//
//var links = [
//	{source: "Baratheo", target: "Lannister"},
//	{source: "Baratheo", target: "stark"},
//	{source: "Lannister", target: "stark"}
//];
//
//var nodes = {};
//
//links.forEach(function(link){
//	link.source = nodes[link.source] || (nodes[link.source] = {name: link.source});
//	link.target = nodes[link.target] || (nodes[link.target] = {name: link.target});
//});
//
//var svg = d3.select("body").append("svg")
//			.attr("width", width/2)
//			.attr("height", height/2);
//
//var force = d3.layout.force()
//			.size([width/2, height/2])
//			.nodes(d3.values(nodes))
//			//.links(links)
//			.charge(charge)
//			.on("tick",  tick)
//			.linkDistance(150)
//			//.gravity(0.1)
//			.friction(0.9)
//			.start();
//
//var link = svg.selectAll(".link")
//				.data(links)
//				.enter()
//				.append("line")
//				.attr("class", "link");
//
//var node = svg.selectAll(".node")
//				.data(force.nodes())
//				.enter()
//				.append("circle")
//				.attr("class", "node")
//				.attr("r", circleR);
//
//function tick(e){
//	console.log("tick");
//	node.attr("cx", function(d){return d.x;})
//		.attr("cy",  function(d) {return d.y;})
//		.call(force.drag);
//
//	// link.attr("x1", function(d){return d.source.x;})
//	// 	.attr("x2",  function(d){return d.target.x;})
//	// 	.attr("y1", function(d){return d.source.y;})
//	// 	.attr("y2", function(d){return d.target.y;});
//}
//function charge(d) {
//  return circleR/2;
//  //return -Math.pow(d.radius, 2.0) / 8;
//}
</script>
</html>